import { createStorefrontClient, SHOPIFY_STOREFRONT_ID_HEADER, getShopifyCookies, SHOPIFY_Y, SHOPIFY_STOREFRONT_Y_HEADER, SHOPIFY_S, SHOPIFY_STOREFRONT_S_HEADER } from '@shopify/hydrogen-react';
export { AnalyticsEventName, AnalyticsPageType, ExternalVideo, IMAGE_FRAGMENT, Image, MediaFile, ModelViewer, Money, ShopPayButton, ShopifySalesChannel, Video, flattenConnection, getClientBrowserParameters, getShopifyCookies, parseMetafield, sendShopifyAnalytics, storefrontApiCustomScalars, useMoney, useShopifyCookies } from '@shopify/hydrogen-react';
import { redirect } from '@remix-run/server-runtime';
import { lazy, useMemo, createElement, Suspense, Fragment } from 'react';
import { useMatches, useLocation } from '@remix-run/react';

function Y(e){let t=Array.isArray(e)?e:[e],n="";for(let r of t)r!=null&&(typeof r=="object"?!!r.body&&typeof r.body=="string"?n+=r.body:n+=JSON.stringify(r):n+=r);return n}var U="public",Te="private",xe="no-store",J={maxAge:"max-age",staleWhileRevalidate:"stale-while-revalidate",sMaxAge:"s-maxage",staleIfError:"stale-if-error"};function x(e){let t=[];return Object.keys(e).forEach(n=>{n==="mode"?t.push(e[n]):J[n]&&t.push(`${J[n]}=${e[n]}`);}),t.join(", ")}function _(){return {mode:xe}}function z(e){if(e?.mode&&e?.mode!==U&&e?.mode!==Te)throw Error("'mode' must be either 'public' or 'private'")}function g(e){return z(e),{mode:U,maxAge:1,staleWhileRevalidate:9,...e}}function H(e){return z(e),{mode:U,maxAge:3600,staleWhileRevalidate:82800,...e}}function j(e){return e}function R(e){return String(e).includes("__proto__")?JSON.parse(e,we):JSON.parse(e)}function we(e,t){if(e!=="__proto__")return t}function b(e,t){return e&&t?{...e,...t}:e||g()}function v(e){return x(b(e))}async function Re(e,t){if(!e)return;let n=await e.match(t);if(!n){t.url;return}return t.url,n}async function be(e,t,n,r){if(!e)return;let o=b(r);t.headers.set("cache-control",v(b(o,{maxAge:(o.maxAge||0)+(o.staleWhileRevalidate||0)})));let a=v(b(o));n.headers.set("cache-control",a),n.headers.set("real-cache-control",a),n.headers.set("cache-put-date",new Date().toUTCString()),t.url,await e.put(t,n);}async function Ee(e,t){!e||(t.url,await e.delete(t));}function Ae(e,t){let n=t.headers.get("cache-put-date"),r=t.headers.get("real-cache-control"),o=0;if(r){let i=r.match(/max-age=(\d*)/);i&&i.length>1&&(o=parseFloat(i[1]));}if(!n)return !1;let c=(new Date().valueOf()-new Date(n).valueOf())/1e3>o;return c&&(e.url,void 0),c}var E={get:Re,set:be,delete:Ee,generateDefaultCacheControlHeader:v,isStale:Ae};function D(e){return `https://shopify.dev/?${e}`}function Ie(e){return e||g()}async function X(e,t){if(!e)return;let n=D(t),r=new Request(n),o=await E.get(e,r);if(!o)return;let a=await o.text();try{return [R(a),o]}catch{return [a,o]}}async function N(e,t,n,r){if(!e)return;let o=D(t),a=new Request(o),s=new Response(JSON.stringify(n));await E.set(e,a,s,Ie(r));}function Z(e,t){return E.isStale(new Request(D(e)),t)}function ke(e,t){return [e,{status:t.status,statusText:t.statusText,headers:Array.from(t.headers.entries())}]}function ee([e,t]){return [e,new Response(e,t)]}var te=e=>!e?.errors,F=new Set;async function $(e,t,{strategy:n=g(),cacheInstance:r,shouldCacheResult:o=()=>!0,waitUntil:a}){if(!r||!n)return t();let s=Y([...typeof e=="string"?[e]:e]),c=await X(r,s);if(c){let[p,f]=c;if(!F.has(s)&&Z(s,f)){F.add(s);let d=Promise.resolve().then(async()=>{try{let h=await t();o(h)&&await N(r,s,h,n);}catch(h){h.message&&(h.message="SWR in sub-request failed: "+h.message),console.error(h);}finally{F.delete(s);}});a?.(d);}return p}let i=await t();if(o(i)){let p=N(r,s,i,n);a?.(p);}return i}async function re(e,t,{cacheInstance:n,cache:r,cacheKey:o=[e,t],shouldCacheResponse:a=()=>!0,waitUntil:s,returnType:c="json"}={}){return !r&&(!t.method||t.method==="GET")&&(r=g()),$(o,async()=>{let i=await fetch(e,t),p;try{p=await i[c]();}catch{p=await i.text();}return ke(p,i)},{cacheInstance:n,waitUntil:s,strategy:r??null,shouldCacheResult:i=>a(...ee(i))}).then(ee)}var ne="Custom-Storefront-Request-Group-ID",oe="Shopify-Storefront-Buyer-IP";function ae(){return typeof crypto<"u"&&!!crypto.randomUUID?crypto.randomUUID():`weak-${Math.random().toString(16).substring(2)}`}var se=new Set,W=e=>{se.has(e)||(console.warn(e),se.add(e));};var B="2023.4.0";var ue=class extends Error{},Ue=e=>e instanceof ue,_e=/(^|}\s)query[\s({]/im,He=/(^|}\s)mutation[\s({]/im;function pe(e){return e.replace(/\s*#.*$/gm,"").replace(/\s+/gm," ").trim()}var je={language:"EN",country:"US"};function Et({storefrontHeaders:e,cache:t,waitUntil:n,buyerIp:r,i18n:o,requestGroupId:a,storefrontId:s,...c}){t||W("Storefront API client created without a cache instance. This may slow down your sub-requests.");let{getPublicTokenHeaders:i,getPrivateTokenHeaders:p,getStorefrontApiUrl:f,getShopifyDomain:d}=createStorefrontClient(c),m=(c.privateStorefrontToken?p:i)({contentType:"json"});if(m[ne]=e?.requestGroupId||a||ae(),(e?.buyerIp||r)&&(m[oe]=e?.buyerIp||r||""),s&&(m[SHOPIFY_STOREFRONT_ID_HEADER]=s),(m["user-agent"]=`Hydrogen ${B}`),e&&e.cookie){let l=getShopifyCookies(e.cookie??"");l[SHOPIFY_Y]&&(m[SHOPIFY_STOREFRONT_Y_HEADER]=l[SHOPIFY_Y]),l[SHOPIFY_S]&&(m[SHOPIFY_STOREFRONT_S_HEADER]=l[SHOPIFY_S]);}e||W('"requestGroupId" and "buyerIp" will be deprecated in the next calendar release. Please use "getStorefrontHeaders"');async function C({query:l,mutation:S,variables:O,cache:ge,headers:T=[],storefrontApiVersion:de}){let me=T instanceof Headers?Object.fromEntries(T.entries()):Array.isArray(T)?Object.fromEntries(T):T;l=l??S;let P={...O};o&&(!O?.country&&/\$country/.test(l)&&(P.country=o.country),!O?.language&&/\$language/.test(l)&&(P.language=o.language));let ye=f({storefrontApiVersion:de}),Se={method:"POST",headers:{...m,...me},body:JSON.stringify({query:l,variables:P})},[M,L]=await re(ye,Se,{cacheInstance:S?void 0:t,cache:ge||g(),shouldCacheResponse:te,waitUntil:n});if(!L.ok){let q;try{q=R(M);}catch{q=[{message:M}];}le(L,q);}let{data:Ce,errors:V}=M;return V?.length&&le(L,V,ue),Ce}return {storefront:{query:(l,S)=>{if(l=pe(l),He.test(l))throw new Error("storefront.query cannot execute mutations");return C({...S,query:l})},mutate:(l,S)=>{if(l=pe(l),_e.test(l))throw new Error("storefront.mutate cannot execute queries");return C({...S,mutation:l})},cache:t,CacheNone:_,CacheLong:H,CacheShort:g,CacheCustom:j,generateCacheControlHeader:x,getPublicTokenHeaders:i,getPrivateTokenHeaders:p,getShopifyDomain:d,getApiUrl:f,isApiError:Ue,i18n:o??je}}}function le(e,t,n=Error){let r=e.headers.get("x-request-id"),o=r?` - Request ID: ${r}`:"";if(t){let a=typeof t=="string"?t:t.map(s=>s.message).join(`
`);throw new n(a+o)}throw new n(`API response error: ${e.status}`+o)}function Ot({cache:e,waitUntil:t}){return (n,r,o)=>$(n,o,{strategy:r,cacheInstance:e,waitUntil:t})}var G=class{#e;constructor(){this.#e=new Map;}add(t){throw new Error("Method not implemented. Use `put` instead.")}addAll(t){throw new Error("Method not implemented. Use `put` instead.")}matchAll(t,n){throw new Error("Method not implemented. Use `match` instead.")}async put(t,n){if(t.method!=="GET")throw new TypeError("Cannot cache response to non-GET request.");if(n.status===206)throw new TypeError("Cannot cache response to a range request (206 Partial Content).");if(n.headers.get("vary")?.includes("*"))throw new TypeError("Cannot cache response with 'Vary: *' header.");this.#e.set(t.url,{body:new Uint8Array(await n.arrayBuffer()),status:n.status,headers:[...n.headers],timestamp:Date.now()});}async match(t){if(t.method!=="GET")return;let n=this.#e.get(t.url);if(!n)return;let{body:r,timestamp:o,...a}=n,s=new Headers(a.headers),c=s.get("cache-control")||s.get("real-cache-control")||"",i=parseInt(c.match(/max-age=(\d+)/)?.[1]||"0",10),p=parseInt(c.match(/stale-while-revalidate=(\d+)/)?.[1]||"0",10),f=(Date.now()-o)/1e3;if(f>i+p){this.#e.delete(t.url);return}let h=f>i;return s.set("cache",h?"STALE":"HIT"),s.set("date",new Date(o).toUTCString()),new Response(r,{status:a.status??200,headers:s})}async delete(t){return this.#e.has(t.url)?(this.#e.delete(t.url),!0):!1}keys(t){let n=[];for(let r of this.#e.keys())(!t||t.url===r)&&n.push(new Request(r));return Promise.resolve(n)}};async function De({storefront:e,request:t,response:n=new Response("Not Found",{status:404})}){let{pathname:r,search:o}=new URL(t.url),a=r+o;try{let{urlRedirects:s}=await e.query(Fe,{variables:{query:"path:"+a}}),c=s?.edges?.[0]?.node?.target;if(c)return new Response(null,{status:302,headers:{location:c}});let i=new URLSearchParams(o),p=i.get("return_to")||i.get("redirect");if(p){if(Ne(p))return redirect(p);console.warn(`Cross-domain redirects are not supported. Tried to redirect from ${a} to ${p}`);}}catch(s){console.error(`Failed to fetch redirects from Storefront API for route ${a}`,s);}return n}function Ne(e){try{new URL(e);}catch{return !0}return !1}var Fe=`#graphql
  query redirects($query: String) {
    urlRedirects(first: 1, query: $query) {
      edges {
        node {
          target
        }
      }
    }
  }
`;function $e({context:e}){let t=e?.storefront;if(!t)throw new Error("GraphiQL: Hydrogen's storefront client must be injected in the loader context.");let n=t.getApiUrl(),r=t.getPublicTokenHeaders()["X-Shopify-Storefront-Access-Token"];return new Response(`
<!DOCTYPE html>
<html lang="en">
  <head>
    <title>GraphiQL</title>
    <style>
      body {
        height: 100%;
        margin: 0;
        width: 100%;
        overflow: hidden;
      }

      #graphiql {
        height: 100vh;
      }
    </style>

    <script
      src="https://unpkg.com/react@17/umd/react.development.js"
      integrity="sha512-Vf2xGDzpqUOEIKO+X2rgTLWPY+65++WPwCHkX2nFMu9IcstumPsf/uKKRd5prX3wOu8Q0GBylRpsDB26R6ExOg=="
      crossorigin="anonymous"
    ><\/script>
    <script
      src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"
      integrity="sha512-Wr9OKCTtq1anK0hq5bY3X/AvDI5EflDSAh0mE9gma+4hl+kXdTJPKZ3TwLMBcrgUeoY0s3dq9JjhCQc7vddtFg=="
      crossorigin="anonymous"
    ><\/script>
    <link rel="stylesheet" href="https://unpkg.com/graphiql/graphiql.min.css" />
  </head>

  <body>
    <div id="graphiql">Loading...</div>
    <script
      src="https://unpkg.com/graphiql/graphiql.min.js"
      type="application/javascript"
    ><\/script>
    <script>
      ReactDOM.render(
        React.createElement(GraphiQL, {
          fetcher: GraphiQL.createFetcher({
            url: '${n}',
            headers: {
              'X-Shopify-Storefront-Access-Token': '${r}',
            }
          }),
          defaultEditorToolsVisibility: true,
          initialTabs: [{query: '{\\n  shop {\\n    name\\n  }\\n}'}]
        }),
        document.getElementById('graphiql'),
      );
    <\/script>
  </body>
</html>
  `,{status:200,headers:{"content-type":"text/html"}})}var y="Error in SEO input: ",A={title:{validate:e=>{if(typeof e!="string")throw new Error(y.concat("`title` should be a string"));if(typeof e=="string"&&e.length>120)throw new Error(y.concat("`title` should not be longer than 120 characters"));return e}},description:{validate:e=>{if(typeof e!="string")throw new Error(y.concat("`description` should be a string"));if(typeof e=="string"&&e.length>155)throw new Error(y.concat("`description` should not be longer than 155 characters"));return e}},url:{validate:e=>{if(typeof e!="string")throw new Error(y.concat("`url` should be a string"));if(typeof e=="string"&&!e.startsWith("http"))throw new Error(y.concat("`url` should be a valid URL"));return e}},handle:{validate:e=>{if(typeof e!="string")throw new Error(y.concat("`handle` should be a string"));if(typeof e=="string"&&!e.startsWith("@"))throw new Error(y.concat("`handle` should start with `@`"));return e}}};function he(e){let t=[];for(let n of Object.keys(e))switch(n){case"title":{let r=I(A.title,e.title),o=We(e?.titleTemplate,r);if(!o)break;t.push(u("title",{title:o}),u("meta",{property:"og:title",content:o}),u("meta",{name:"twitter:title",content:o}));break}case"description":{let r=I(A.description,e.description);if(!r)break;t.push(u("meta",{name:"description",content:r}),u("meta",{property:"og:description",content:r}),u("meta",{name:"twitter:description",content:r}));break}case"url":{let r=I(A.url,e.url);if(!r)break;t.push(u("link",{rel:"canonical",href:r}),u("meta",{property:"og:url",content:r}));break}case"handle":{let r=I(A.handle,e.handle);if(!r)break;t.push(u("meta",{name:"twitter:site",content:r}),u("meta",{name:"twitter:creator",content:r}));break}case"media":{let r,o=Q(e.media);for(let a of o)if(typeof a=="string"&&t.push(u("meta",{name:"og:image",content:a})),a&&typeof a=="object"){let s=a.type||"image",c=a?{url:a?.url,secure_url:a?.url,type:Be(a.url),width:a?.width,height:a?.height,alt:a?.altText}:{};for(let i of Object.keys(c))c[i]&&(r=c[i],t.push(u("meta",{property:`og:${s}:${i}`,content:r},c.url)));}break}case"jsonLd":{let r=Q(e.jsonLd),o=0;for(let a of r){if(typeof a!="object")continue;let s=u("script",{type:"application/ld+json",children:JSON.stringify(a)},`json-ld-${a?.["@type"]||a?.name||o++}`);t.push(s);}break}case"alternates":{let r=Q(e.alternates);for(let o of r){if(!o)continue;let{language:a,url:s,default:c}=o,i=a?`${a}${c?"-default":""}`:void 0;t.push(u("link",{rel:"alternate",hrefLang:i,href:s}));}break}case"robots":{if(!e.robots)break;let{maxImagePreview:r,maxSnippet:o,maxVideoPreview:a,noArchive:s,noFollow:c,noImageIndex:i,noIndex:p,noSnippet:f,noTranslate:d,unavailableAfter:h}=e.robots,m=[s&&"noarchive",i&&"noimageindex",f&&"nosnippet",d&&"notranslate",r&&`max-image-preview:${r}`,o&&`max-snippet:${o}`,a&&`max-video-preview:${a}`,h&&`unavailable_after:${h}`],C=(p?"noindex":"index")+","+(c?"nofollow":"follow");for(let l of m)l&&(C+=`,${l}`);t.push(u("meta",{name:"robots",content:C}));break}}return t.flat().sort((n,r)=>n.key.localeCompare(r.key))}function u(e,t,n){let r={tag:e,props:{},key:""};return e==="title"?(r.children=t.title,r.key=K(r),r):e==="script"?(r.children=typeof t.children=="string"?t.children:"",r.key=K(r,n),delete t.children,r.props=t,r):(r.props=t,Object.keys(r.props).forEach(o=>!r.props[o]&&delete r.props[o]),r.key=K(r,n),r)}function K(e,t){let{tag:n,props:r}=e;if(n==="title")return "0-title";if(n==="meta"){let o=r.content===t&&typeof r.property=="string"&&!r.property.endsWith("secure_url")&&"0";return [n,...[t,o],r.property||r.name].filter(s=>s).join("-")}return n==="link"?[n,r.rel,r.hrefLang||r.media].filter(a=>a).join("-").replace(/\s+/g,"-"):n==="script"?`${n}-${t}`:`${n}-${r.type}`}function We(e,t){if(!!t)return e?typeof e=="function"?e(t):e.replace("%s",t??""):t}function Be(e){switch(e&&e.split(".").pop()){case"svg":return "image/svg+xml";case"png":return "image/png";case"gif":return "image/gif";case"swf":return "application/x-shockwave-flash";case"mp3":return "audio/mpeg";case"jpg":case"jpeg":default:return "image/jpeg"}}function Q(e){return Array.isArray(e)?e:[e]}function I(e,t){try{return e.validate(t)}catch(n){return console.warn(n.message),t}}var Je=lazy(()=>import('./log-seo-tags-N7J66FN6.js'));function ze({debug:e}){let t=useMatches(),n=useLocation(),r=useMemo(()=>t.flatMap(s=>{let{handle:c,...i}=s,p={...i,...n},f=c?.seo,d=i?.data?.seo;return !f&&!d?[]:f?k(c.seo,p):[d]}).reduce((s,c)=>{Object.keys(c).forEach(p=>!c[p]&&delete c[p]);let{jsonLd:i}=c;return i?s?.jsonLd?Array.isArray(i)?{...s,...c,jsonLd:[...s.jsonLd,...i]}:{...s,...c,jsonLd:[...s.jsonLd,i]}:{...s,...c,jsonLd:[i]}:{...s,...c}},{}),[t,n]),{html:o,loggerMarkup:a}=useMemo(()=>{let s=he(r),c=s.map(p=>p.tag==="script"?createElement(p.tag,{...p.props,key:p.key,dangerouslySetInnerHTML:{__html:p.children}}):createElement(p.tag,{...p.props,key:p.key},p.children)),i=createElement(Suspense,{fallback:null},createElement(Je,{headTags:s}));return {html:c,loggerMarkup:i}},[r]);return createElement(Fragment,null,o,e&&a)}function k(e,...t){if(e instanceof Function)return k(e(...t),...t);let n={};return Array.isArray(e)?(n=e.reduce((r,o)=>[...r,k(o)],[]),n):e instanceof Object?(Object.entries(e).forEach(([o,a])=>{n[o]=k(a,...t);}),n):e}

export { j as CacheCustom, H as CacheLong, _ as CacheNone, g as CacheShort, G as InMemoryCache, ze as Seo, Et as createStorefrontClient, Ot as createWithCache_unstable, x as generateCacheControlHeader, $e as graphiqlLoader, Ue as isStorefrontApiError, De as storefrontRedirect };
//# sourceMappingURL=out.js.map
//# sourceMappingURL=index.js.map